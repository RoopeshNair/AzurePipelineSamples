# A pipeline with three sequential jobs
# Output variables from previous jobs are being referred

jobs:
  - job: A
    pool: Hosted VS2017
    steps:
        - powershell: echo "##vso[task.setvariable variable=myOutputVarA;isOutput=true]this is the output variable set in job A"
          name: setoutputvar
          displayName: 'set output variable'
        - script: echo $(setoutputvar.myOutputVarA)
          displayName: 'Run a script'
  - job: B
    dependsOn: A
    pool: Hosted VS2017
    variables:
        myVarFromJobA: $[dependencies.A.outputs['setoutputvar.myOutputVarA']]
    steps:
        - powershell: echo "##vso[task.setvariable variable=myOutputVarB;isOutput=true]this is the output variable set in job B"
          name: setoutputvar
          displayName: 'set output variable'
        - script: |
            echo $(myVarFromJobA)  
            echo $(setoutputvar.myOutputVarB)
          name: echovar
  - job: C
    dependsOn: B
    pool: Hosted VS2017
    variables:
        myVarFromJobA: $[dependencies.A.outputs['setoutputvar.myOutputVarA']]
        myVarFromJobB: $[dependencies.B.outputs['setoutputvar.myOutputVarB']]
    steps:
        - script: |
            echo $(myVarFromJobA) 
            echo $(myVarFromJobB)  
          name: echovar
